## iPerf-Report - применяется для измерения канала связи внутри туннеля (ipsec/gre) и оповещении, в случае низкой скорости.

![Image alt](https://github.com/Lifailon/iPerf-Report/blob/rsa/Screen/Telegram-Report-150Mbits.jpg)

Для измерения применяется [iperf3](https://github.com/esnet/iperf).

Требования: 
* Два сервера на базе Windows.
* Серверная часть. Необходимо скопировать директорию в любое удобное место и запустить в планировщик **iperf-Server-Restart.ps1** (для запуска используется путь .\iperf\iperf3.exe), который будет проверять процесс запущенного процесса сервера и в случае остановки (например, после перезагрузки), перезапускать его.
* Клиентская часть. Так же скопировать директорию и добавить в планировщик **iperf-Client-Report-Telegram.ps1**, в котором нужно указать свои значения:

$srv = "server-name" # Имя сервера, на котором запущена серверная часть

$trigger = "150" # Триггерное значение (в Mbits/sec), для отправки оповещения

$token_bot = "5517149522:AAFop4_darMpTT7VgLpY2hjkDkkV1dzmGNM" # Токен вашего бота в Telegram

$id_chat = "-609779646" # id чата Telegram, для отправки уведомления

Результаты измерения логируются, после каждого запуска:
![Image alt](https://github.com/Lifailon/iPerf-Report/blob/rsa/Screen/iperf-log.jpg)

> По умолчанию для серверной и клиентской части мною указан порт 5221, который необходимо открыть в firewall. Прогоняется 1100 Mbytes, на мой взгляд самое оптимальное значение. Если будет использоваться меньше, необходимо заменить в скрипте GBytes на MBytes для корректного парсинга вывода.

В дальнейшем добавлю скрипты bash и шаблон Zabbix.
